/**
 * Copyright (c) 2011 Asa Baylus, http://baylus.com/
 * licensed under the MIT
 */
/**
 * Resizes the height of the iframe in blue dragon applications to accomodate content contained in the iframe without verticle scrollbars
 * @author Asa Baylus
 * @version 1.0.1
 * 
 * Copyright (c) 2011 Asa Baylus, http://baylus.com/
 * 
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 * 
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

(function(c){c.fn.extend({iframeFitContent:function(j,e){var i=j,b=c(this),a,g,k=j||{},h=(new Date).getTime().toString(),l="iframeWrapper"+h,f={init:function(){return this.each(function(){var d=c(this);d.one("load",function(){d.attr("scrolling","no").attr({src:this.src+"?z="+h}).data({originalHeight:d.height(),originalWidth:d.width(),loadTime:h,wrapper:l}).bind("load",function(){return f.render.apply(d)});d.trigger("iframeFitContentReady",[h,"1.0.1"])})})},render:function(){b.css({visibility:"hidden"});
a=b.contents().find("body");b.data("loadTime")===h&&a.children().wrapAll("<div id="+l+"></div>");g=a.find("#iframeWrapper"+b.data("loadTime"));g.css({"padding-top":a.css("margin-top"),"padding-bottom":a.css("margin-bottom"),"padding-left":a.css("margin-left"),"padding-right":a.css("margin-right"),"border-left-width":a.css("border-left-width"),"border-right-width":a.css("border-right-width"),"border-top-width":a.css("border-top-width"),"border-bottom-width":a.css("border-bottom-width"),"border-left-style":a.css("border-left-style"),
"border-right-style":a.css("border-right-style"),"border-top-style":a.css("border-top-style"),"border-bottom-style":a.css("border-bottom-style"),"border-left-color":a.css("border-left-color"),"border-right-color":a.css("border-right-color"),"border-top-color":a.css("border-top-color"),"border-bottom-color":a.css("border-bottom-color"),position:"absolute",height:"auto",width:"auto"});a.css({border:"none","margin-top":"0","margin-bottom":"0","margin-left":"0","margin-right":"0"});k.resize!=="width"&&
b.height(g.outerHeight(true));k.resize!=="height"&&b.width(g.outerWidth(true));g.css({position:"relative",zoom:"1"});b.css("visibility","visible");c(this).trigger("iframeFitcontentRendered",[this]);return this},originalWidth:function(){return this.each(function(){return c(this).data("originalWidth")})},originalHeight:function(){return c(this).data("originalHeight")},destroy:function(){var d=b.data("originalHeight"),m=b.data("originalWidth"),n=b.contents().find("body").find("#iframeWrapper"+b.data("loadTime")),
o=n.attr("style");n.children().unwrap();c(this).attr("style",o).css({height:d,width:m});console.log("destroy",m+" , "+d)}};if(f[i])e=i;i=c.extend({resize:"both"},i);if(f[e])return f[e].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e)return f.init.apply(c(this),arguments);else c.error("Method "+f[e]+" does not exist on jQuery.iframeFitContent")}});return this})(jQuery);